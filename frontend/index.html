<!DOCTYPE html>
<html>
    <head>
        <link rel="Stylesheet" href="css.css" />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
        />
        <meta charset="utf-8" />
        <title>BrawlStars-dle</title>
    </head>
    <body>
        <header id="toph">
            <img
                src="images/arrow.png"
                class="logobutton"
                draggable="false"
                onclick="hidemenu();"
                id="logoarr"
            />
            <img
                src="images/logo.png"
                id="top"
                height="7vh"
                draggable="false"
            />
            <img
                src="images/darkmode.png"
                class="logobutton"
                draggable="false"
                onclick="tdarkmode();"
            />
        </header>
        <nav id="navmain">
            <span class="links"
                ><a id="linkdaily" href="daily.html" class="aNav"
                    >DAILY</a
                ></span
            >
            <span class="links"
                ><a
                    id="linknormal"
                    href="index.html"
                    class="aNav"
                    style="color: white"
                    >NORMAL</a
                ></span
            >
            <span class="links"
                ><a id="linkhard" href="hard.html" class="aNav">HARD</a></span
            >
            <span class="links"
                ><a id="linktimed" href="timed.html" class="aNav"
                    >TIMED</a
                ></span
            >
            <span class="links"
                ><a id="linktimed" href="login.html" class="aNav"
                    >LOGIN (BETA)</a
                ></span
            >
        </nav>

        <main align="center">
            <video
                id="bgvideo"
                src="images/background.mp4"
                autoplay
                loop
                muted
                poster="images/backgroundstill.png"
            ></video>
            <div
                style="
                    padding-top: 0.7vh;
                    padding-bottom: 0.9vh;
                    font-size: 3vh;
                "
                id="instructions"
            >
                guessing game!<br />
                enter your guess here:
            </div>

            <input
                list="brawlers_list"
                type="text"
                id="input"
                style="margin-bottom: 2vh"
            />
            <button id="guessbutton">></button>

            <div style="padding-bottom: 0.9vh; font-size: 3vh" id="remaining">
                guesses remaining: <span id="rem_numb">6</span>
            </div>

            <table id="main_table">
                <tr>
                    <td style="opacity: 0%" class="tdtop"></td>
                    <td align="center" class="tdtop">rarity</td>
                    <td align="center" class="tdtop">wallbreak</td>
                    <td align="center" class="tdtop">p11 health</td>
                    <td align="center" class="tdtop">projectiles</td>
                    <td align="center" class="tdtop">year</td>
                </tr>
            </table>

            <div id="keyboardTop">
                <div id="brawlerSuggestion"></div>
                <div id="toggleKeyboard" onclick="toggleKeyboard()">-</div>
            </div>
            <div id="keyboard1">
                <div onclick="kbPress('q')" class="keyboardKey">Q</div>
                <div onclick="kbPress('w')" class="keyboardKey">W</div>
                <div onclick="kbPress('e')" class="keyboardKey">E</div>
                <div onclick="kbPress('r')" class="keyboardKey">R</div>
                <div onclick="kbPress('t')" class="keyboardKey">T</div>
                <div onclick="kbPress('y')" class="keyboardKey">Y</div>
                <div onclick="kbPress('u')" class="keyboardKey">U</div>
                <div onclick="kbPress('i')" class="keyboardKey">I</div>
                <div onclick="kbPress('o')" class="keyboardKey">O</div>
                <div onclick="kbPress('p')" class="keyboardKey">P</div>
            </div>
            <div id="keyboard2">
                <div onclick="kbPress('a')" class="keyboardKey">A</div>
                <div onclick="kbPress('s')" class="keyboardKey">S</div>
                <div onclick="kbPress('d')" class="keyboardKey">D</div>
                <div onclick="kbPress('f')" class="keyboardKey">F</div>
                <div onclick="kbPress('g')" class="keyboardKey">G</div>
                <div onclick="kbPress('h')" class="keyboardKey">H</div>
                <div onclick="kbPress('j')" class="keyboardKey">J</div>
                <div onclick="kbPress('k')" class="keyboardKey">K</div>
                <div onclick="kbPress('l')" class="keyboardKey">L</div>
            </div>
            <div id="keyboard3">
                <div onclick="kbPress('z')" class="keyboardKey">Z</div>
                <div onclick="kbPress('x')" class="keyboardKey">X</div>
                <div onclick="kbPress('c')" class="keyboardKey">C</div>
                <div onclick="kbPress('v')" class="keyboardKey">V</div>
                <div onclick="kbPress('b')" class="keyboardKey">B</div>
                <div onclick="kbPress('n')" class="keyboardKey">N</div>
                <div onclick="kbPress('m')" class="keyboardKey">M</div>
            </div>
            <div id="keyboard4">
                <div onclick="kbPress('&')" class="keyboardKey">&</div>
                <div onclick="kbPress('.')" class="keyboardKey">.</div>
                <div onclick="kbPress('-')" class="keyboardKey">-</div>
                <div onclick="kbPress('8')" class="keyboardKey">8</div>
                <div
                    onclick="kbPress(' ')"
                    class="keyboardKey"
                    id="keyboardSpace"
                >
                    _
                </div>
                <div onclick="kbBack()" class="keyboardKey" id="keyboardBack">
                    <img
                        src="images/backspace.png"
                        style="width: 6vw; height: auto"
                    />
                </div>
                <div class="keyboardKey" id="keyboardGuess">></div>
            </div>

            <div
                style="
                    position: absolute;
                    height: 100vh;
                    width: 100vw;
                    background-color: rgba(0, 0, 0, 0.3);
                    top: 0px;
                "
                id="shadow"
                class="endscreen"
            ></div>

            <div
                style="
                    position: absolute;
                    left: 10vw;
                    top: 9.3vh;
                    width: 80vw;
                    height: 64vh;
                "
                id="endscreen"
                class="endscreen"
            >
                <center>
                    <img
                        id="endscreen-img"
                        src=""
                        draggable="false"
                        style="height: 16.6vh; width: auto; margin-top: 10px"
                    /><br />
                    <div id="endscreen-text">
                        the brawler was BIBI!<br />
                        congratulations!
                    </div>
                    <br />
                    <img id="streak-img" src="images/streakanim.gif" /><span
                        id="streak1"
                        >0 </span
                    ><span id="streak2">in a row!</span><br />
                    <span id="streak3">best streak: </span
                    ><span id="streak4">2</span><br /><br />
                    <button onclick="go_back()" id="back"><b><</b></button
                    ><button id="play-again">PLAY AGAIN</button><br /><br />

                    <a href="https://youtube.com/@Krias" target="_blank"
                        ><img src="images/youtube.png" />/ @Krias</a
                    >
                    <a
                        class="redlink"
                        href="https://youtu.be/Q9dk4gli0yk"
                        target="_blank"
                    >
                        > NEW VIDEO</a
                    ><br />
                    <a href="https://twitter.com/@KriasBS" target="_blank"
                        ><img src="images/twitter.png" />/ @KriasBS</a
                    >
                </center>
            </div>
        </main>
        <script type="text/javascript" src="data.js"></script>
        <script type="text/javascript" src="functions.js"></script>
        <script defer>
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            var keyboard = true;
            var darkmode =
                localStorage.getItem("darkmode") || urlParams.get("dm") || "0";
            localStorage.setItem("darkmode", darkmode);

            if (darkmode == "1") {
                darkmode = "0";
                tdarkmode();
            }

            if (localStorage.getItem("menuHid") == null) {
                localStorage.setItem("menuHid", false);
            } else if (localStorage.getItem("menuHid") == "true") {
                document.getElementById("top").style.transition = "0s";
                document.getElementById("logoarr").style.transition = "0s";
                document.getElementById("navmain").style.transition = "0s";
                var x = document.getElementsByClassName("logobutton");
                for (var i = 0; i < x.length; i++) {
                    x[i].style.transition = "0s";
                }
                x = document.getElementsByClassName("links");
                for (var i = 0; i < x.length; i++) {
                    x[i].style.transition = "0s";
                }
                localStorage.setItem("menuHid", false);
                hidemenu();
                document.getElementById("top").style.transition = "0.5s all";
                document.getElementById("logoarr").style.transition =
                    "0.5s all";
                document.getElementById("navmain").style.transition =
                    "0.5s all";
                var x = document.getElementsByClassName("logobutton");
                for (var i = 0; i < x.length; i++) {
                    x[i].style.transition = "0.5s all";
                }
                x = document.getElementsByClassName("links");
                for (var i = 0; i < x.length; i++) {
                    x[i].style.transition = "0.5s all";
                }
            }

            document.addEventListener("contextmenu", (event) =>
                event.preventDefault()
            );

            window.onresize = function () {
                checkSize();
            };
            window.onload = function () {
                checkSize();
            };
            checkSize();

            var obj = JSON.parse(localStorage.getItem("currentNormalGame"));
            if (localStorage.getItem("currentNormalGame") == null) {
                localStorage.setItem(
                    "currentNormalGame",
                    JSON.stringify({
                        gameStatus: "unstarted",
                        guesses: 0,
                        gameString: "",
                        currentWinStreak: localStorage.getItem("winsN") || 0,
                        maxWinStreak: localStorage.getItem("winsNbest") || 0,
                        m_brawler: Math.round(Math.random() * 81),
                    })
                );
            } else if (obj.gameStatus != "unstarted") {
                var tempobj = {
                    gameStatus: "unstarted",
                    guesses: 0,
                    gameString: "",
                    currentWinStreak: obj.currentWinStreak,
                    maxWinStreak: obj.maxWinStreak,
                    m_brawler: obj.m_brawler,
                };

                lastGameArray = obj.gameString.split("|");
                for (var i = 0; i < lastGameArray.length; i++) {
                    document.getElementById("input").value = lastGameArray[i];
                    tempobj = guess(tempobj);
                }
            }

            document.addEventListener("click", function (event) {
                if (event.target && event.target.id === "play-again") {
                    obj = JSON.parse(localStorage.getItem("currentNormalGame"));
                    obj.gameStatus = "unstarted";
                    obj.guesses = 0;
                    obj.gameString = "";
                    obj.m_brawler = Math.round(Math.random() * 81);
                    localStorage.setItem(
                        "currentNormalGame",
                        JSON.stringify(obj)
                    );
                    location.reload();
                } else if (
                    (event.target && event.target.id === "guessbutton") ||
                    (event.target && event.target.id === "keyboardGuess")
                ) {
                    obj = JSON.parse(localStorage.getItem("currentNormalGame"));
                    obj = guess(obj);
                    localStorage.setItem(
                        "currentNormalGame",
                        JSON.stringify(obj)
                    );
                }
            });

            document.addEventListener("keypress", function (event) {
                if (event.keyCode == 13) {
                    obj = JSON.parse(localStorage.getItem("currentNormalGame"));
                    obj = guess(obj);
                    localStorage.setItem(
                        "currentNormalGame",
                        JSON.stringify(obj)
                    );
                }
            });

            function guess(obj) {
                if (obj.gameStatus == "won" || obj.gameStatus == "lost") {
                    return obj;
                }

                var guess_text = document
                    .getElementById("input")
                    .value.toLowerCase();
                guess_text = autocorrect(guess_text);
                document.getElementById("input").value = "";
                updateSuggestions();

                var brawler_nr = 0;
                while (guess_text != brawlers[brawler_nr].name) {
                    brawler_nr++;
                    if (brawler_nr == Object.keys(brawlers).length) {
                        return obj;
                    }
                }
                var goodGuesses = 0;
                obj.guesses++;
                obj.gameStatus = "started";
                obj.gameString += brawlers[brawler_nr].name + "|";

                var number = document.getElementById("rem_numb");
                number.innerHTML = 6 - obj.guesses;
                if (obj.guesses > 3) number.style.color = "orange";
                if (obj.guesses > 4) number.style.color = "red";

                var main_table = document.getElementById("main_table");

                var row = main_table.insertRow(1);
                var cell = row.insertCell(0);
                cell.className = "imageCell";
                cell.align = "center";
                cell.innerHTML =
                    "<img src='images/" +
                    brawlers[brawler_nr].name +
                    ".png' class='imgguess' draggable='false'>";
                animateCSS(cell, "flipInX", "0s");

                /*  RARITY  */ var cell = row.insertCell(1);
                cell.align = "center";
                cell.innerHTML = brawlers[brawler_nr].rarity;
                if (
                    brawlers[brawler_nr].rarity ==
                    brawlers[obj.m_brawler].rarity
                ) {
                    cell.className = "correct";
                    goodGuesses++;
                } else {
                    cell.className = "incorrect";
                }
                animateCSS(cell, "flipInX", "0.2s");

                // if rarity name too long
                if (
                    brawlers[brawler_nr].rarity == "Legendary" ||
                    brawlers[brawler_nr].rarity == "Chromatic"
                )
                    cell.style = "font-size: min(3vw, 2vh)";

                /*  WALLBREAK  */ var cell = row.insertCell(2);
                cell.align = "center";
                cell.innerHTML = brawlers[brawler_nr].wall;
                if (brawlers[brawler_nr].wall == brawlers[obj.m_brawler].wall) {
                    cell.className = "correct";
                    goodGuesses++;
                } else {
                    cell.className = "incorrect";
                }
                animateCSS(cell, "flipInX", "0.4s");

                /*  HEALTH  */ var cell = row.insertCell(3);
                cell.align = "center";
                cell.innerHTML = brawlers[brawler_nr].health;
                if (
                    brawlers[brawler_nr].health ==
                    brawlers[obj.m_brawler].health
                ) {
                    cell.className = "correct";
                    goodGuesses++;
                } else {
                    cell.className = "incorrect";
                }

                if (
                    brawlers[brawler_nr].health > brawlers[obj.m_brawler].health
                )
                    cell.style = "background-image: url(images/lower.png)";
                if (
                    brawlers[brawler_nr].health < brawlers[obj.m_brawler].health
                )
                    cell.style = "background-image: url(images/higher.png)";
                animateCSS(cell, "flipInX", "0.6s");

                /*  PROJECTILES  */ var cell = row.insertCell(4);
                cell.align = "center";
                cell.innerHTML = brawlers[brawler_nr].projectiles;
                if (
                    brawlers[brawler_nr].projectiles ==
                    brawlers[obj.m_brawler].projectiles
                ) {
                    cell.className = "correct";
                    goodGuesses++;
                } else {
                    cell.className = "incorrect";
                }

                if (
                    brawlers[brawler_nr].projectiles >
                    brawlers[obj.m_brawler].projectiles
                )
                    cell.style = "background-image: url(images/lower.png)";
                if (
                    brawlers[brawler_nr].projectiles <
                    brawlers[obj.m_brawler].projectiles
                )
                    cell.style = "background-image: url(images/higher.png)";
                animateCSS(cell, "flipInX", "0.8s");

                /*  YEAR  */ var cell = row.insertCell(5);
                cell.align = "center";
                cell.innerHTML = brawlers[brawler_nr].year;
                if (brawlers[brawler_nr].year == brawlers[obj.m_brawler].year) {
                    cell.className = "correct";
                    goodGuesses++;
                } else {
                    cell.className = "incorrect";
                }

                if (brawlers[brawler_nr].year > brawlers[obj.m_brawler].year)
                    cell.style = "background-image: url(images/lower.png)";
                if (brawlers[brawler_nr].year < brawlers[obj.m_brawler].year)
                    cell.style = "background-image: url(images/higher.png)";
                animateCSS(cell, "flipInX", "1s");

                // -------------------------------------------------------------------------------------------------------- //

                if (goodGuesses == 5) obj.m_brawler = brawler_nr;

                if (obj.guesses == 6 && brawler_nr != obj.m_brawler) {
                    obj.gameStatus = "lost";
                    obj.currentWinStreak = 0;
                    animate_endscreen(brawlers[obj.m_brawler].name);
                    document.getElementById("endscreen-text").innerHTML =
                        "the correct brawler was " +
                        brawlers[obj.m_brawler].name.toUpperCase() +
                        "<br>better luck next time!";
                    document.getElementById("streak-img").style.display =
                        "none";
                    document.getElementById("streak1").style.display = "none";
                    document.getElementById("streak2").style.display = "none";
                    document.getElementById("streak4").innerHTML =
                        obj.maxWinStreak;
                }
                if (brawler_nr == obj.m_brawler) {
                    obj.currentWinStreak++;
                    obj.maxWinStreak = Math.max(
                        obj.currentWinStreak,
                        obj.maxWinStreak
                    );
                    obj.gameStatus = "won";
                    animate_endscreen(brawlers[obj.m_brawler].name);
                    document.getElementById("endscreen-text").innerHTML =
                        "you guessed " +
                        brawlers[obj.m_brawler].name.toUpperCase() +
                        " correctly<br>congratulations!";
                    document.getElementById("streak1").innerHTML =
                        obj.currentWinStreak + " ";
                    document.getElementById("streak4").innerHTML =
                        obj.maxWinStreak;
                }
                return obj;
            }

            function go_back() {
                var shadow = document.getElementById("shadow");
                var endscreen = document.getElementById("endscreen");
                shadow.style.display = "none";
                endscreen.style.display = "none";

                var inp = document.getElementById("input");
                inp.style.opacity = "0%";
                inp.style.width = "0px";

                var button = document.getElementById("guessbutton");
                button.id = "play-again";
                button.innerHTML = "PLAY AGAIN";
                button.style = "box-sizing: border-box; height: min(7vw, 4vh)";

                var new_text = document.getElementById("instructions");
                new_text.innerHTML =
                    "brawler guessing game!<br>click here to play again";
            }
        </script>
        <datalist id="brawlers_list">
            <option value="Shelly"></option>

            <option value="Nita"></option>
            <option value="Colt"></option>
            <option value="Bull"></option>
            <option value="Brock"></option>
            <option value="El Primo"></option>
            <option value="Barley"></option>
            <option value="Poco"></option>
            <option value="Rosa"></option>

            <option value="Jessie"></option>
            <option value="Dynamike"></option>
            <option value="Tick"></option>
            <option value="8-bit"></option>
            <option value="Rico"></option>
            <option value="Darryl"></option>
            <option value="Penny"></option>
            <option value="Carl"></option>
            <option value="Jacky"></option>
            <option value="Gus"></option>

            <option value="Bo"></option>
            <option value="Emz"></option>
            <option value="Stu"></option>
            <option value="Piper"></option>
            <option value="Pam"></option>
            <option value="Frank"></option>
            <option value="Bibi"></option>
            <option value="Bea"></option>
            <option value="Nani"></option>
            <option value="Edgar"></option>
            <option value="Griff"></option>
            <option value="Grom"></option>
            <option value="Bonnie"></option>
            <option value="Hank"></option>

            <option value="Mortis"></option>
            <option value="Tara"></option>
            <option value="Gene"></option>
            <option value="Max"></option>
            <option value="Mr. P"></option>
            <option value="Sprout"></option>
            <option value="Byron"></option>
            <option value="Squeak"></option>
            <option value="Gray"></option>
            <option value="Willow"></option>
            <option value="Doug"></option>
            <option value="Chuck"></option>

            <option value="Spike"></option>
            <option value="Crow"></option>
            <option value="Leon"></option>
            <option value="Sandy"></option>
            <option value="Amber"></option>
            <option value="Meg"></option>
            <option value="Chester"></option>

            <option value="Gale"></option>
            <option value="Surge"></option>
            <option value="Colette"></option>
            <option value="Lou"></option>
            <option value="Ruffs"></option>
            <option value="Belle"></option>
            <option value="Buzz"></option>
            <option value="Ash"></option>
            <option value="Lola"></option>
            <option value="Fang"></option>
            <option value="Eve"></option>
            <option value="Janet"></option>
            <option value="Otis"></option>
            <option value="Sam"></option>
            <option value="Buster"></option>
            <option value="Mandy"></option>
            <option value="R-T"></option>
            <option value="Maisie"></option>
            <option value="Cordelius"></option>
            <option value="Pearl"></option>
            <option value="Charlie"></option>

            <option value="Mico"></option>
            <option value="Kit"></option>
            <option value="Larry & Lawrie"></option>
            <option value="Angelo"></option>
            <option value="Melodie"></option>
            <option value="Lily"></option>
            <option value="Draco"></option>
            <option value="Berry"></option>
            <option value="Clancy"></option>
            <option value="Moe"></option>
            <option value="Kenji"></option>
            <option value="Juju"></option>
        </datalist>
    </body>
</html>
